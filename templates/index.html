<html lang="en">
<head>
    <meta charset="UTF-8">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-EVSTQN3/azprG1Anm3QDgpJLIm9Nao0Yz1ztcQTwFspd3yD65VohhpuuCOmLASjC" crossorigin="anonymous">
    <title>Spun data upload</title>
</head>
<body>
  <h1>Spun data upload process</h1>
  <div>
      You are logged in with the name: {{name}} <br>
      with the email: {{email}}
  </div>
  <ul class="list-group">
    {% if current_user.is_authenticated and current_user.approved %}
      <li class="list-group-item">        
        {% for filename, file_data in gz_filedata.items() %}
            {% if 'percent_uploaded' in file_data %}
                {% if file_data.percent_uploaded == 100 %}
                    You have uploaded the file {{ filename }}<br>
                {% else %}
                    {% if file_data.percent_uploaded > 0 %}
                        You have previously started uploading a file: {{ filename }}<br>
                        Already uploaded: {{ file_data.percent_uploaded }}%<br>
                        Enter the form and select the same file to resume uploading<br>
                    {% endif %}
                {% endif %}
            {% endif %}
        {% endfor %}          
        
        <a href="/form_resume">Resume Upload</a>
      </li>
      <li class="list-group-item"><a href="/form">Start a new upload</a></li>
    {% endif %}
    {% if current_user.is_authenticated and current_user.admin %}
      <li class="list-group-item"><a href="{{ url_for('user.users') }}">Users</a></li>
    {% endif %}
    <li class="list-group-item"><a href="/logout">Logout</a></li>
  </ul>
</body>
</html>